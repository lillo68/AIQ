<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parser Betmonitor & AIQ Calculator - 3 & 2 Esiti</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #ffffff;
            color: #333;
            line-height: 1.5;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        /* Layout principale */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 1400px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid #eaeaea;
            margin-bottom: 24px;
        }

        .tab {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            background: none;
            transition: all 0.2s ease;
            position: relative;
        }

        .tab:hover {
            color: #2563eb;
            background: #f8f9fa;
        }

        .tab.active {
            color: #2563eb;
            font-weight: 600;
            border-color: #eaeaea;
            border-bottom-color: white;
            background: white;
            border-radius: 6px 6px 0 0;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 1px;
            background: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: #fff;
            border: 1px solid #eaeaea;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .card h2 {
            font-size: 16px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card h2::before {
            content: '';
            width: 4px;
            height: 16px;
            background: #2563eb;
            border-radius: 2px;
        }

        /* CALCOLATORE AIQ STYLES */
        .aiq-calculator {
            background: #ffffff;
            border: 1px solid #eaeaea;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .aiq-calculator h2 {
            text-align: center;
            color: #0369a1;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }

        .aiq-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .aiq-table th, .aiq-table td {
            border: 1px solid #e5e7eb;
            padding: 6px;
            text-align: center;
        }

        .aiq-table th { 
            background: #f1f5f9; 
            font-weight: 600;
            color: #475569;
        }

        .aiq-input {
            width: 70px;
            text-align: center;
            padding: 4px 6px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 13px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .aiq-input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }

        .aiq-result { 
            font-weight: bold; 
            font-size: 14px;
        }

        .aiq-value {
            background: #dcfce7;
            color: #166534;
        }

        .aiq-novalue {
            background: #fee2e2;
            color: #991b1b;
        }

        .aiq-ok {
            background: #dcfce7;
            color: #166534;
        }

        .aiq-warn {
            background: #fef9c3;
            color: #854d0e;
        }

        /* Parser styles */
        textarea {
            width: 100%;
            min-height: 300px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.4;
            resize: vertical;
            background: #fafafa;
            color: #333;
        }

        textarea:focus {
            outline: none;
            border-color: #2563eb;
            background: #fff;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #fff;
            color: #333;
            flex: 1;
            min-width: 120px;
        }

        button:hover {
            background: #f8f9fa;
            border-color: #ccc;
        }

        .btn-parse {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .btn-parse:hover {
            background: #1d4ed8;
            border-color: #1d4ed8;
        }

        .btn-clear {
            background: #fff;
            color: #666;
        }

        .btn-clear:hover {
            background: #f8f9fa;
            color: #333;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 20px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .stat-summary-item {
            text-align: center;
        }

        .stat-summary-value {
            font-size: 20px;
            font-weight: 600;
            color: #1a1a1a;
            display: block;
        }

        .stat-summary-label {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        /* Tabella statistiche compatte */
        .stats-table-container {
            margin-top: 20px;
            border: 1px solid #eaeaea;
            border-radius: 6px;
            overflow: hidden;
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
        }

        .stats-table th {
            background: #f8f9fa;
            padding: 10px 12px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #eaeaea;
        }

        .stats-table td {
            padding: 10px 12px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        .stats-table tr:last-child td {
            border-bottom: none;
        }

        .stats-table tr:hover {
            background: #fafafa;
        }

        /* Stili per le colonne Pinnacle e Betfair */
        .stat-pinnacle .stat-table-value { color: #7c3aed; }
        .stat-betfair .stat-table-value { color: #ea580c; }

        /* Header per Pinnacle e Betfair */
        .esito-header.pinnacle { 
            border-left: 3px solid #7c3aed;
            color: #7c3aed;
        }
        .esito-header.betfair { 
            border-left: 3px solid #ea580c;
            color: #ea580c;
        }
        
        /* Header colonne esiti */
        .esito-header {
            font-weight: 600;
            color: #1a1a1a;
            padding: 10px 12px;
            background: #f8f9fa;
        }

        .esito-header.quote-1 { 
            border-left: 3px solid #2563eb;
            color: #2563eb;
        }
        .esito-header.quote-x { 
            border-left: 3px solid #9333ea;
            color: #9333ea;
        }
        .esito-header.quote-2 { 
            border-left: 3px solid #059669;
            color: #059669;
        }
        .esito-header.quote-yes { 
            border-left: 3px solid #2563eb;
            color: #2563eb;
        }
        .esito-header.quote-no { 
            border-left: 3px solid #dc2626;
            color: #dc2626;
        }

        /* Valori nelle celle */
        .stat-table-value {
            font-size: 14px;
            font-weight: 600;
            color: #1a1a1a;
            display: block;
        }

        .stat-table-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: block;
            margin-top: 2px;
        }

        .stat-table-bookmaker {
            font-size: 10px;
            color: #888;
            margin-top: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Colori per i tipi di statistiche */
        .stat-min .stat-table-value { color: #059669; }
        .stat-max .stat-table-value { color: #dc2626; }
        .stat-sharp .stat-table-value { color: #ea580c; }

        /* Tabella bookmaker */
        .results-container {
            margin-top: 20px;
            border: 1px solid #eaeaea;
            border-radius: 6px;
            overflow: hidden;
        }

        .bookmaker-table {
            width: 100%;
            border-collapse: collapse;
        }

        .bookmaker-table thead {
            background: #f8f9fa;
            border-bottom: 1px solid #eaeaea;
        }

        .bookmaker-table th {
            padding: 12px 16px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .bookmaker-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #eaeaea;
            font-size: 13px;
        }

        .bookmaker-table tr:last-child td {
            border-bottom: none;
        }

        .bookmaker-table tr:hover {
            background: #f8f9fa;
        }

        /* Stili per l'ordinamento */
        .sortable-header {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 20px !important;
            transition: background-color 0.2s ease;
        }

        .sortable-header:hover {
            background-color: #f0f0f0;
        }

        .sortable-header::after {
            content: '';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            opacity: 0.3;
        }

        .sortable-header.asc::after {
            border-bottom: 6px solid #666;
            border-top: none;
            opacity: 1;
        }

        .sortable-header.desc::after {
            border-top: 6px solid #666;
            border-bottom: none;
            opacity: 1;
        }

        .bookmaker-name {
            font-weight: 500;
            color: #1a1a1a;
        }

        .bookmaker-name.sharp {
            color: #ea580c;
            font-weight: 600;
        }

        .quote-cell {
            text-align: center;
            font-weight: 500;
            border-radius: 4px;
            padding: 4px 8px;
            font-feature-settings: "tnum";
        }

        .quote-1-cell { color: #2563eb; background: #eff6ff; }
        .quote-x-cell { color: #9333ea; background: #faf5ff; }
        .quote-2-cell { color: #059669; background: #f0fdf4; }
        .quote-yes-cell { color: #2563eb; background: #eff6ff; }
        .quote-no-cell { color: #dc2626; background: #fef2f2; }

        .export-options {
            display: flex;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .export-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 13px;
            background: #fff;
            color: #666;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .export-btn:hover {
            background: #f8f9fa;
            border-color: #ccc;
        }

        .export-btn.csv { color: #059669; border-color: #d1fae5; background: #f0fdf4; }
        .export-btn.json { color: #2563eb; border-color: #dbeafe; background: #eff6ff; }
        .export-btn.txt { color: #ea580c; border-color: #ffedd5; background: #fff7ed; }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background: #1a1a1a;
            color: white;
            border-radius: 6px;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .debug-info {
            font-size: 12px;
            color: #666;
            margin-top: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }

        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }

        .empty-state {
            padding: 40px 20px;
            text-align: center;
            color: #888;
            font-size: 14px;
        }

        .empty-state .icon {
            font-size: 24px;
            margin-bottom: 8px;
            opacity: 0.5;
        }

        .example-toggle {
            font-size: 12px;
            color: #2563eb;
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 8px;
            margin-top: 8px;
            text-decoration: underline;
        }

        .example-toggle:hover {
            color: #1d4ed8;
        }
        
        /* Tooltip AIQ */
        .aiq-tooltip {
            position: fixed;
            pointer-events: none;
            background: #020617;
            color: #f8fafc;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.1s;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ“Š Parser Betmonitor & AIQ Calculator</h1>
            <p>Estrazione quote bookmaker e calcolo ValueBet AIQ per mercati a 3 e 2 esiti</p>
        </div>

        <div class="main-layout">
            <!-- Colonna sinistra: Calcolatori AIQ -->
            <div class="left-column">
                <!-- Calcolatore AIQ CALCIO (3 esiti) -->
                <div class="aiq-calculator">
                    <h2>AIQ CALCIO - 3 Esiti</h2>
                    <table class="aiq-table">
                        <tr>
                            <th>Parametro</th>
                            <th>HOME</th>
                            <th>DRAW</th>
                            <th>AWAY</th>
                        </tr>
                        
                        <tr>
                            <td>Quota Sharp</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'HOME')" id="AIQ CALCIO_Sharp_HOME" value="2.40" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'DRAW')" id="AIQ CALCIO_Sharp_DRAW" value="3.20" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'AWAY')" id="AIQ CALCIO_Sharp_AWAY" value="3.00" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Media</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'HOME')" id="AIQ CALCIO_Media_HOME" value="2.30" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'DRAW')" id="AIQ CALCIO_Media_DRAW" value="3.10" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'AWAY')" id="AIQ CALCIO_Media_AWAY" value="2.90" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Min</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'HOME')" id="AIQ CALCIO_Min_HOME" value="2.20" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'DRAW')" id="AIQ CALCIO_Min_DRAW" value="3.00" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'AWAY')" id="AIQ CALCIO_Min_AWAY" value="2.80" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Max</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'HOME')" id="AIQ CALCIO_Max_HOME" value="2.50" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'DRAW')" id="AIQ CALCIO_Max_DRAW" value="3.40" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ CALCIO', 'AWAY')" id="AIQ CALCIO_Max_AWAY" value="3.20" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Sharp / Media</td>
                            <td id="AIQ CALCIO_sm_HOME"></td>
                            <td id="AIQ CALCIO_sm_DRAW"></td>
                            <td id="AIQ CALCIO_sm_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>Max / Min</td>
                            <td id="AIQ CALCIO_mm_HOME"></td>
                            <td id="AIQ CALCIO_mm_DRAW"></td>
                            <td id="AIQ CALCIO_mm_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>Sharp / Soft</td>
                            <td id="AIQ CALCIO_ss_HOME"></td>
                            <td id="AIQ CALCIO_ss_DRAW"></td>
                            <td id="AIQ CALCIO_ss_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>FORZA VALUE</td>
                            <td id="AIQ CALCIO_fv_HOME"></td>
                            <td id="AIQ CALCIO_fv_DRAW"></td>
                            <td id="AIQ CALCIO_fv_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>VERDETTO</td>
                            <td id="AIQ CALCIO_res_HOME" class="aiq-result"></td>
                            <td id="AIQ CALCIO_res_DRAW" class="aiq-result"></td>
                            <td id="AIQ CALCIO_res_AWAY" class="aiq-result"></td>
                        </tr>
                    </table>
                </div>

                <!-- Calcolatore AIQ TENNIS (2 esiti) -->
                <div class="aiq-calculator">
                    <h2>AIQ TENNIS - 2 Esiti</h2>
                    <table class="aiq-table">
                        <tr>
                            <th>Parametro</th>
                            <th>HOME</th>
                            <th>AWAY</th>
                        </tr>
                        
                        <tr>
                            <td>Quota Sharp</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'HOME')" id="AIQ TENNIS_Sharp_HOME" value="2.10" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'AWAY')" id="AIQ TENNIS_Sharp_AWAY" value="1.80" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Media</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'HOME')" id="AIQ TENNIS_Media_HOME" value="1.95" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'AWAY')" id="AIQ TENNIS_Media_AWAY" value="1.75" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Min</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'HOME')" id="AIQ TENNIS_Min_HOME" value="1.85" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'AWAY')" id="AIQ TENNIS_Min_AWAY" value="1.65" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Quota Max</td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'HOME')" id="AIQ TENNIS_Max_HOME" value="2.20" class="aiq-input"></td>
                            <td><input type="number" step="0.01" oninput="calculateAiq('AIQ TENNIS', 'AWAY')" id="AIQ TENNIS_Max_AWAY" value="1.90" class="aiq-input"></td>
                        </tr>
                        
                        <tr>
                            <td>Sharp / Media</td>
                            <td id="AIQ TENNIS_sm_HOME"></td>
                            <td id="AIQ TENNIS_sm_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>Max / Min</td>
                            <td id="AIQ TENNIS_mm_HOME"></td>
                            <td id="AIQ TENNIS_mm_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>Sharp / Soft</td>
                            <td id="AIQ TENNIS_ss_HOME"></td>
                            <td id="AIQ TENNIS_ss_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>FORZA VALUE</td>
                            <td id="AIQ TENNIS_fv_HOME"></td>
                            <td id="AIQ TENNIS_fv_AWAY"></td>
                        </tr>
                        
                        <tr>
                            <td>VERDETTO</td>
                            <td id="AIQ TENNIS_res_HOME" class="aiq-result"></td>
                            <td id="AIQ TENNIS_res_AWAY" class="aiq-result"></td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- Colonna destra: Parser -->
            <div class="right-column">
                <!-- Tabs -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('tab-3esiti')">3 Esiti (1X2)</div>
                    <div class="tab" onclick="switchTab('tab-2esiti')">2 Esiti (SÃ¬/No)</div>
                </div>

                <!-- Tab 3 Esiti -->
                <div id="tab-3esiti" class="tab-content active">
                    <div class="card">
                        <h2>Dati Input - 3 Esiti</h2>
                        <textarea id="inputData3" placeholder="Incolla i dati copiati da Betmonitor (formato 3 esiti)...">
efbet
efbet.net
3.69
3.41
2.28
99.7%
1xbet
1xbet
3.61
3.46
2.23
98.6%
tipico
tipico
3.60
3.30
2.10
94.3%
betfair
betfair
3.60
3.40
2.32
99.7%
betsensation
betsensation
3.56
3.30
2.22
96.6%
pinnacle
pinnacle
3.52
3.27
2.28
97.2%</textarea>
                        
                        <button class="example-toggle" onclick="loadExample3Esiti()">Carica esempio 3 esiti</button>
                        
                        <div class="button-group">
                            <button class="btn-parse" onclick="parseData3Esiti()">Parsa Dati</button>
                            <button class="btn-clear" onclick="clearData3Esiti()">Pulisci</button>
                        </div>

                        <div class="help-text">
                            Formato atteso: nome bookmaker, dominio, 3 quote (1, X, 2), percentuale
                        </div>

                        <div class="stats-summary">
                            <div class="stat-summary-item">
                                <span class="stat-summary-value" id="totalBooks3">0</span>
                                <span class="stat-summary-label">Bookmaker totali</span>
                            </div>
                            <div class="stat-summary-item">
                                <span class="stat-summary-value" id="sharpBooks3">0</span>
                                <span class="stat-summary-label">Sharp</span>
                            </div>
                        </div>

                        <div class="debug-info" id="debugInfo3"></div>
                    </div>

                    <div class="card">
                        <h2>Statistiche Quote - 3 Esiti</h2>
                        
                        <!-- Tabella statistiche compatte -->
                        <div class="stats-table-container">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th style="width: 120px; text-align: left;">Statistica</th>
                                        <th style="width: 25%;" class="esito-header quote-1">1</th>
                                        <th style="width: 25%;" class="esito-header quote-x">X</th>
                                        <th style="width: 25%;" class="esito-header quote-2">2</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Riga Media -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Media</td>
                                        <td>
                                            <span class="stat-table-value" id="avgQuote1">0.00</span>
                                            <span class="stat-table-label">tutti i book</span>
                                        </td>
                                        <td>
                                            <span class="stat-table-value" id="avgQuoteX">0.00</span>
                                            <span class="stat-table-label">tutti i book</span>
                                        </td>
                                        <td>
                                            <span class="stat-table-value" id="avgQuote2">0.00</span>
                                            <span class="stat-table-label">tutti i book</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Minima -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Minima</td>
                                        <td class="stat-min">
                                            <span class="stat-table-value" id="minQuote1">0.00</span>
                                            <span class="stat-table-label">migliore offerta</span>
                                            <div class="stat-table-bookmaker" id="minBook1">-</div>
                                        </td>
                                        <td class="stat-min">
                                            <span class="stat-table-value" id="minQuoteX">0.00</span>
                                            <span class="stat-table-label">migliore offerta</span>
                                            <div class="stat-table-bookmaker" id="minBookX">-</div>
                                        </td>
                                        <td class="stat-min">
                                            <span class="stat-table-value" id="minQuote2">0.00</span>
                                            <span class="stat-table-label">migliore offerta</span>
                                            <div class="stat-table-bookmaker" id="minBook2">-</div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Massima -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Massima</td>
                                        <td class="stat-max">
                                            <span class="stat-table-value" id="maxQuote1">0.00</span>
                                            <span class="stat-table-label">peggiore offerta</span>
                                            <div class="stat-table-bookmaker" id="maxBook1">-</div>
                                        </td>
                                        <td class="stat-max">
                                            <span class="stat-table-value" id="maxQuoteX">0.00</span>
                                            <span class="stat-table-label">peggiore offerta</span>
                                            <div class="stat-table-bookmaker" id="maxBookX">-</div>
                                        </td>
                                        <td class="stat-max">
                                            <span class="stat-table-value" id="maxQuote2">0.00</span>
                                            <span class="stat-table-label">peggiore offerta</span>
                                            <div class="stat-table-bookmaker" id="maxBook2">-</div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Pinnacle -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Pinnacle</td>
                                        <td class="stat-pinnacle">
                                            <span class="stat-table-value" id="pinnacleQuote1">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-pinnacle">
                                            <span class="stat-table-value" id="pinnacleQuoteX">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-pinnacle">
                                            <span class="stat-table-value" id="pinnacleQuote2">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                    </tr>

                                    <!-- Riga Betfair -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Betfair</td>
                                        <td class="stat-betfair">
                                            <span class="stat-table-value" id="betfairQuote1">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-betfair">
                                            <span class="stat-table-value" id="betfairQuoteX">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-betfair">
                                            <span class="stat-table-value" id="betfairQuote2">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Tabella bookmaker -->
                        <h2 style="margin-top: 30px;">Dettaglio Bookmaker - 3 Esiti</h2>
                        <div class="results-container">
                            <table class="bookmaker-table">
                                <thead>
                                    <tr>
                                        <th class="sortable-header" onclick="sortTable3('bookmaker')" data-sort="none">Bookmaker</th>
                                        <th class="sortable-header" onclick="sortTable3('quote1')" style="text-align: center;" data-sort="none">1</th>
                                        <th class="sortable-header" onclick="sortTable3('quoteX')" style="text-align: center;" data-sort="none">X</th>
                                        <th class="sortable-header" onclick="sortTable3('quote2')" style="text-align: center;" data-sort="none">2</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTable3">
                                    <!-- I dati verranno inseriti qui dinamicamente -->
                                </tbody>
                            </table>
                            <div id="emptyState3" class="empty-state" style="display: none;">
                                <div class="icon">ðŸ“Š</div>
                                <div>Nessun dato disponibile</div>
                                <div style="font-size: 12px; margin-top: 4px;">Incolla i dati e clicca "Parsa Dati"</div>
                            </div>
                        </div>

                        <div class="export-options">
                            <button class="export-btn csv" onclick="exportToCSV3()">Esporta CSV</button>
                            <button class="export-btn json" onclick="exportToJSON3()">Esporta JSON</button>
                            <button class="export-btn txt" onclick="exportToTXT3()">Esporta TXT</button>
                        </div>
                    </div>
                </div>

                <!-- Tab 2 Esiti -->
                <div id="tab-2esiti" class="tab-content">
                    <div class="card">
                        <h2>Dati Input - 2 Esiti</h2>
                        <textarea id="inputData2" placeholder="Incolla i dati copiati da Betmonitor (formato 2 esiti)...">
efbet
efbet.net
8.40
1.11
98.0 %
betfair
betfair
8.24
1.12
98.6 %
dafabet
dafabet
7.10
1.10
95.0 %
ggbet
ggbet
6.99
1.09
94.0 %
bet365
bet365
6.60
1.11
94.8 %
pmbet
pmbet
6.40
1.11
94.3 %
casapariurilor
casapariurilor
6.40
1.12
95.1 %
wwin
wwin
5.90
1.10
92.1 %
tippmix_hu
tippmix_hu
5.25
1.09
89.2 %</textarea>
                        
                        <button class="example-toggle" onclick="loadExample2Esiti()">Carica esempio 2 esiti</button>
                        
                        <div class="button-group">
                            <button class="btn-parse" onclick="parseData2Esiti()">Parsa Dati</button>
                            <button class="btn-clear" onclick="clearData2Esiti()">Pulisci</button>
                        </div>

                        <div class="help-text">
                            Formato atteso: nome bookmaker, dominio, 2 quote (SÃ¬, No), percentuale
                        </div>

                        <div class="stats-summary">
                            <div class="stat-summary-item">
                                <span class="stat-summary-value" id="totalBooks2">0</span>
                                <span class="stat-summary-label">Bookmaker totali</span>
                            </div>
                            <div class="stat-summary-item">
                                <span class="stat-summary-value" id="sharpBooks2">0</span>
                                <span class="stat-summary-label">Sharp</span>
                            </div>
                        </div>

                        <div class="debug-info" id="debugInfo2"></div>
                    </div>

                    <div class="card">
                        <h2>Statistiche Quote - 2 Esiti</h2>
                        
                        <!-- Tabella statistiche compatte -->
                        <div class="stats-table-container">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th style="width: 120px; text-align: left;">Statistica</th>
                                        <th style="width: 40%;" class="esito-header quote-yes">SÃ¬ / Over / Alt</th>
                                        <th style="width: 40%;" class="esito-header quote-no">No / Under / Alt</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Riga Media -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Media</td>
                                        <td>
                                            <span class="stat-table-value" id="avgQuoteYes">0.00</span>
                                            <span class="stat-table-label">tutti i book</span>
                                        </td>
                                        <td>
                                            <span class="stat-table-value" id="avgQuoteNo">0.00</span>
                                            <span class="stat-table-label">tutti i book</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Minima -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Minima</td>
                                        <td class="stat-min">
                                            <span class="stat-table-value" id="minQuoteYes">0.00</span>
                                            <span class="stat-table-label">migliore offerta</span>
                                            <div class="stat-table-bookmaker" id="minBookYes">-</div>
                                        </td>
                                        <td class="stat-min">
                                            <span class="stat-table-value" id="minQuoteNo">0.00</span>
                                            <span class="stat-table-label">migliore offerta</span>
                                            <div class="stat-table-bookmaker" id="minBookNo">-</div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Massima -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Massima</td>
                                        <td class="stat-max">
                                            <span class="stat-table-value" id="maxQuoteYes">0.00</span>
                                            <span class="stat-table-label">peggiore offerta</span>
                                            <div class="stat-table-bookmaker" id="maxBookYes">-</div>
                                        </td>
                                        <td class="stat-max">
                                            <span class="stat-table-value" id="maxQuoteNo">0.00</span>
                                            <span class="stat-table-label">peggiore offerta</span>
                                            <div class="stat-table-bookmaker" id="maxBookNo">-</div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Riga Pinnacle -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Pinnacle</td>
                                        <td class="stat-pinnacle">
                                            <span class="stat-table-value" id="pinnacleQuoteYes">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-pinnacle">
                                            <span class="stat-table-value" id="pinnacleQuoteNo">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                    </tr>

                                    <!-- Riga Betfair -->
                                    <tr>
                                        <td style="text-align: left; font-size: 13px; font-weight: 500; color: #333;">Betfair</td>
                                        <td class="stat-betfair">
                                            <span class="stat-table-value" id="betfairQuoteYes">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                        <td class="stat-betfair">
                                            <span class="stat-table-value" id="betfairQuoteNo">-</span>
                                            <span class="stat-table-label">quote esatta</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Tabella bookmaker -->
                        <h2 style="margin-top: 30px;">Dettaglio Bookmaker - 2 Esiti</h2>
                        <div class="results-container">
                            <table class="bookmaker-table">
                                <thead>
                                    <tr>
                                        <th class="sortable-header" onclick="sortTable2('bookmaker')" data-sort="none">Bookmaker</th>
                                        <th class="sortable-header" onclick="sortTable2('quoteYes')" style="text-align: center;" data-sort="none">SÃ¬ / Over / Alt</th>
                                        <th class="sortable-header" onclick="sortTable2('quoteNo')" style="text-align: center;" data-sort="none">No / Under / Alt</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTable2">
                                    <!-- I dati verranno inseriti qui dinamicamente -->
                                </tbody>
                            </table>
                            <div id="emptyState2" class="empty-state" style="display: none;">
                                <div class="icon">ðŸ“Š</div>
                                <div>Nessun dato disponibile</div>
                                <div style="font-size: 12px; margin-top: 4px;">Incolla i dati e clicca "Parsa Dati"</div>
                            </div>
                        </div>

                        <div class="export-options">
                            <button class="export-btn csv" onclick="exportToCSV2()">Esporta CSV</button>
                            <button class="export-btn json" onclick="exportToJSON2()">Esporta JSON</button>
                            <button class="export-btn txt" onclick="exportToTXT2()">Esporta TXT</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>
    <div class="aiq-tooltip" id="aiqTooltip"></div>

    <script>
        // ==============================
        // VARIABILI GLOBALI
        // ==============================
        let parsedData3 = [];  // Dati per 3 esiti
        let parsedData2 = [];  // Dati per 2 esiti
        const sharpBookmakers = ['pinnacle', 'betfair'];
        
        // AIQ Calculator Constants
        const TH = { sm:5, mm:8, ss:7 };
        const NEAR = 0.5;
        const aiqTooltip = document.getElementById("aiqTooltip");
        
        // Ordinamento per 3 esiti
        let currentSort3 = {
            column: null,
            direction: 'asc'
        };
        
        // Ordinamento per 2 esiti
        let currentSort2 = {
            column: null,
            direction: 'asc'
        };

        // ==============================
        // FUNZIONI TAB
        // ==============================
        function switchTab(tabId) {
            // Nascondi tutti i tab
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostra il tab selezionato
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }

        // ==============================
        // FUNZIONI AIQ CALCULATOR
        // ==============================
        function showAiqTooltip(text, e) {
            aiqTooltip.innerText = text;
            aiqTooltip.style.left = e.clientX + 12 + "px";
            aiqTooltip.style.top  = e.clientY + 12 + "px";
            aiqTooltip.style.opacity = 1;
        }
        
        function hideAiqTooltip() {
            aiqTooltip.style.opacity = 0;
        }

        function applyAiqTooltip(el, text) {
            el.onmousemove = e => showAiqTooltip(text, e);
            el.onmouseleave = hideAiqTooltip;
        }

        function styleAiqCell(el, value, th) {
            el.className = "";
            if (value >= th) {
                el.classList.add("aiq-ok");
                applyAiqTooltip(el, "ðŸŸ¢ Condizione OK");
            } else if (value >= th - NEAR) {
                el.classList.add("aiq-warn");
                applyAiqTooltip(el, "ðŸŸ¡ Vicino alla soglia");
            } else {
                applyAiqTooltip(el, "ðŸ”´ Condizione NON OK");
            }
        }

        function calculateAiq(title, outcome) {
            const g = k => parseFloat(document.getElementById(`${title}_${k}_${outcome}`).value);
            const sharp=g("Sharp"), media=g("Media"), min=g("Min"), max=g("Max");
            if([sharp,media,min,max].some(isNaN)) return;

            const sm=((sharp-media)/media)*100;
            const mm=((max-min)/min)*100;
            const ss=((sharp-min)/min)*100;
            const fv=(sm+mm+ss)/3;

            const smEl=document.getElementById(`${title}_sm_${outcome}`);
            const mmEl=document.getElementById(`${title}_mm_${outcome}`);
            const ssEl=document.getElementById(`${title}_ss_${outcome}`);
            const fvEl=document.getElementById(`${title}_fv_${outcome}`);
            const resEl=document.getElementById(`${title}_res_${outcome}`);

            smEl.innerText=sm.toFixed(2)+"%";
            mmEl.innerText=mm.toFixed(2)+"%";
            ssEl.innerText=ss.toFixed(2)+"%";
            fvEl.innerText=fv.toFixed(2)+"%";

            styleAiqCell(smEl,sm,TH.sm);
            styleAiqCell(mmEl,mm,TH.mm);
            styleAiqCell(ssEl,ss,TH.ss);

            const value = sm>=TH.sm && mm>=TH.mm && ss>=TH.ss;

            fvEl.className = value ? "aiq-ok" : "";
            applyAiqTooltip(fvEl, value ? "â­ ValueBet confermata" : "â„¹ Media delle metriche");

            resEl.innerText = value ? "VALUE" : "NO VALUE";
            resEl.className = value ? "aiq-result aiq-value" : "aiq-result aiq-novalue";
        }

        // ==============================
        // FUNZIONI 3 ESITI
        // ==============================
        function loadExample3Esiti() {
            const example = `efbet
efbet.net
3.69
3.41
2.28
99.7%
1xbet
1xbet
3.61
3.46
2.23
98.6%
tipico
tipico
3.60
3.30
2.10
94.3%
betfair
betfair
3.60
3.40
2.32
99.7%
betsensation
betsensation
3.56
3.30
2.22
96.6%
pinnacle
pinnacle
3.52
3.27
2.28
97.2%`;
            
            document.getElementById('inputData3').value = example;
            showNotification('Esempio 3 esiti caricato', 'info');
        }

        function parseData3Esiti() {
            const input = document.getElementById('inputData3').value.trim();
            if (!input) {
                showNotification('Incolla prima i dati da Betmonitor', 'error');
                return;
            }

            parsedData3 = [];
            const debugInfo = [];
            const lines = input.split('\n').map(line => line.trim()).filter(line => line !== '');

            let i = 0;
            while (i < lines.length) {
                // Pattern: nome, dominio, 3 quote, percentuale
                if (i + 5 < lines.length) {
                    const bookmakerName = lines[i].toLowerCase();
                    const quote1 = parseFloat(lines[i + 2]);
                    const quoteX = parseFloat(lines[i + 3]);
                    const quote2 = parseFloat(lines[i + 4]);

                    if (!isNaN(quote1) && !isNaN(quoteX) && !isNaN(quote2)) {
                        parsedData3.push({
                            bookmaker: bookmakerName,
                            quote1: quote1,
                            quoteX: quoteX,
                            quote2: quote2,
                            isSharp: sharpBookmakers.includes(bookmakerName)
                        });
                        i += 6; // Salta al prossimo bookmaker
                        continue;
                    }
                }
                i++;
            }

            if (parsedData3.length === 0) {
                showNotification('Nessun dato valido trovato', 'error');
                document.getElementById('debugInfo3').innerHTML = debugInfo.join('<br>');
                document.getElementById('debugInfo3').style.display = 'block';
            } else {
                document.getElementById('debugInfo3').style.display = 'none';
                displayResults3();
                updateStats3();
                updateAiqCalculatorFromParser3();
                resetSort3();
                showNotification(`Trovati ${parsedData3.length} bookmaker (3 esiti)`, 'success');
            }
        }

        function calculateStatistics3() {
            if (parsedData3.length === 0) {
                return {
                    avg1: 0, avgX: 0, avg2: 0,
                    min1: 0, minX: 0, min2: 0,
                    max1: 0, maxX: 0, max2: 0,
                    minBook1: '', minBookX: '', minBook2: '',
                    maxBook1: '', maxBookX: '', maxBook2: '',
                    pinnacle1: null, pinnacleX: null, pinnacle2: null,
                    betfair1: null, betfairX: null, betfair2: null,
                    sharpCount: 0
                };
            }

            let min1 = parsedData3[0].quote1, minX = parsedData3[0].quoteX, min2 = parsedData3[0].quote2;
            let max1 = parsedData3[0].quote1, maxX = parsedData3[0].quoteX, max2 = parsedData3[0].quote2;
            let minBook1 = parsedData3[0].bookmaker, minBookX = parsedData3[0].bookmaker, minBook2 = parsedData3[0].bookmaker;
            let maxBook1 = parsedData3[0].bookmaker, maxBookX = parsedData3[0].bookmaker, maxBook2 = parsedData3[0].bookmaker;
            let total1 = 0, totalX = 0, total2 = 0;
            let sharpCount = 0;

            let pinnacle1 = null, pinnacleX = null, pinnacle2 = null;
            let betfair1 = null, betfairX = null, betfair2 = null;

            parsedData3.forEach(item => {
                total1 += item.quote1;
                totalX += item.quoteX;
                total2 += item.quote2;

                if (item.quote1 < min1) { min1 = item.quote1; minBook1 = item.bookmaker; }
                if (item.quote1 > max1) { max1 = item.quote1; maxBook1 = item.bookmaker; }
                if (item.quoteX < minX) { minX = item.quoteX; minBookX = item.bookmaker; }
                if (item.quoteX > maxX) { maxX = item.quoteX; maxBookX = item.bookmaker; }
                if (item.quote2 < min2) { min2 = item.quote2; minBook2 = item.bookmaker; }
                if (item.quote2 > max2) { max2 = item.quote2; maxBook2 = item.bookmaker; }
                
                if (item.bookmaker === 'pinnacle') {
                    pinnacle1 = item.quote1;
                    pinnacleX = item.quoteX;
                    pinnacle2 = item.quote2;
                    sharpCount++;
                }
                if (item.bookmaker === 'betfair') {
                    betfair1 = item.quote1;
                    betfairX = item.quoteX;
                    betfair2 = item.quote2;
                    sharpCount++;
                }
            });

            return {
                avg1: total1 / parsedData3.length,
                avgX: totalX / parsedData3.length,
                avg2: total2 / parsedData3.length,
                min1, minX, min2,
                max1, maxX, max2,
                minBook1, minBookX, minBook2,
                maxBook1, maxBookX, maxBook2,
                pinnacle1, pinnacleX, pinnacle2,
                betfair1, betfairX, betfair2,
                sharpCount
            };
        }

        function updateStats3() {
            const stats = calculateStatistics3();
            
            document.getElementById('totalBooks3').textContent = parsedData3.length;
            document.getElementById('sharpBooks3').textContent = stats.sharpCount;

            document.getElementById('avgQuote1').textContent = stats.avg1.toFixed(2);
            document.getElementById('minQuote1').textContent = stats.min1.toFixed(2);
            document.getElementById('maxQuote1').textContent = stats.max1.toFixed(2);
            document.getElementById('minBook1').textContent = formatBookmakerName(stats.minBook1);
            document.getElementById('maxBook1').textContent = formatBookmakerName(stats.maxBook1);
            
            document.getElementById('pinnacleQuote1').textContent = stats.pinnacle1 !== null ? stats.pinnacle1.toFixed(2) : '-';
            document.getElementById('betfairQuote1').textContent = stats.betfair1 !== null ? stats.betfair1.toFixed(2) : '-';

            document.getElementById('avgQuoteX').textContent = stats.avgX.toFixed(2);
            document.getElementById('minQuoteX').textContent = stats.minX.toFixed(2);
            document.getElementById('maxQuoteX').textContent = stats.maxX.toFixed(2);
            document.getElementById('minBookX').textContent = formatBookmakerName(stats.minBookX);
            document.getElementById('maxBookX').textContent = formatBookmakerName(stats.maxBookX);
            
            document.getElementById('pinnacleQuoteX').textContent = stats.pinnacleX !== null ? stats.pinnacleX.toFixed(2) : '-';
            document.getElementById('betfairQuoteX').textContent = stats.betfairX !== null ? stats.betfairX.toFixed(2) : '-';

            document.getElementById('avgQuote2').textContent = stats.avg2.toFixed(2);
            document.getElementById('minQuote2').textContent = stats.min2.toFixed(2);
            document.getElementById('maxQuote2').textContent = stats.max2.toFixed(2);
            document.getElementById('minBook2').textContent = formatBookmakerName(stats.minBook2);
            document.getElementById('maxBook2').textContent = formatBookmakerName(stats.maxBook2);
            
            document.getElementById('pinnacleQuote2').textContent = stats.pinnacle2 !== null ? stats.pinnacle2.toFixed(2) : '-';
            document.getElementById('betfairQuote2').textContent = stats.betfair2 !== null ? stats.betfair2.toFixed(2) : '-';
        }

        function updateAiqCalculatorFromParser3() {
            const stats = calculateStatistics3();
            
            // Aggiorna il calcolatore AIQ CALCIO con i dati del parser
            if (stats.pinnacle1 !== null) {
                document.getElementById('AIQ CALCIO_Sharp_HOME').value = stats.pinnacle1.toFixed(2);
                document.getElementById('AIQ CALCIO_Sharp_DRAW').value = stats.pinnacleX.toFixed(2);
                document.getElementById('AIQ CALCIO_Sharp_AWAY').value = stats.pinnacle2.toFixed(2);
            } else if (stats.betfair1 !== null) {
                document.getElementById('AIQ CALCIO_Sharp_HOME').value = stats.betfair1.toFixed(2);
                document.getElementById('AIQ CALCIO_Sharp_DRAW').value = stats.betfairX.toFixed(2);
                document.getElementById('AIQ CALCIO_Sharp_AWAY').value = stats.betfair2.toFixed(2);
            }
            
            document.getElementById('AIQ CALCIO_Media_HOME').value = stats.avg1.toFixed(2);
            document.getElementById('AIQ CALCIO_Media_DRAW').value = stats.avgX.toFixed(2);
            document.getElementById('AIQ CALCIO_Media_AWAY').value = stats.avg2.toFixed(2);
            
            document.getElementById('AIQ CALCIO_Min_HOME').value = stats.min1.toFixed(2);
            document.getElementById('AIQ CALCIO_Max_HOME').value = stats.max1.toFixed(2);
            
            document.getElementById('AIQ CALCIO_Min_DRAW').value = stats.minX.toFixed(2);
            document.getElementById('AIQ CALCIO_Max_DRAW').value = stats.maxX.toFixed(2);
            
            document.getElementById('AIQ CALCIO_Min_AWAY').value = stats.min2.toFixed(2);
            document.getElementById('AIQ CALCIO_Max_AWAY').value = stats.max2.toFixed(2);
            
            // Ricalcola AIQ
            calculateAiq('AIQ CALCIO', 'HOME');
            calculateAiq('AIQ CALCIO', 'DRAW');
            calculateAiq('AIQ CALCIO', 'AWAY');
        }

        function displayResults3() {
            const tableBody = document.getElementById('resultsTable3');
            const emptyState = document.getElementById('emptyState3');
            
            if (parsedData3.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            
            tableBody.innerHTML = parsedData3.map(item => `
                <tr>
                    <td>
                        <span class="bookmaker-name ${item.isSharp ? 'sharp' : ''}">
                            ${formatBookmakerName(item.bookmaker)}
                            ${item.isSharp ? ' âš¡' : ''}
                        </span>
                    </td>
                    <td style="text-align: center;">
                        <span class="quote-cell quote-1-cell">${item.quote1.toFixed(2)}</span>
                    </td>
                    <td style="text-align: center;">
                        <span class="quote-cell quote-x-cell">${item.quoteX.toFixed(2)}</span>
                    </td>
                    <td style="text-align: center;">
                        <span class="quote-cell quote-2-cell">${item.quote2.toFixed(2)}</span>
                    </td>
                </tr>
            `).join('');
        }

        function clearData3Esiti() {
            document.getElementById('inputData3').value = '';
            parsedData3 = [];
            displayResults3();
            updateStats3();
            resetSort3();
            showNotification('Dati 3 esiti puliti', 'info');
        }

        // ==============================
        // FUNZIONI 2 ESITI
        // ==============================
        function loadExample2Esiti() {
            const example = `efbet
efbet.net
8.40
1.11
98.0 %
betfair
betfair
8.24
1.12
98.6 %
dafabet
dafabet
7.10
1.10
95.0 %
ggbet
ggbet
6.99
1.09
94.0 %
bet365
bet365
6.60
1.11
94.8 %
pmbet
pmbet
6.40
1.11
94.3 %
casapariurilor
casapariurilor
6.40
1.12
95.1 %
wwin
wwin
5.90
1.10
92.1 %
tippmix_hu
tippmix_hu
5.25
1.09
89.2 %`;
            
            document.getElementById('inputData2').value = example;
            showNotification('Esempio 2 esiti caricato', 'info');
        }

        function parseData2Esiti() {
            const input = document.getElementById('inputData2').value.trim();
            if (!input) {
                showNotification('Incolla prima i dati da Betmonitor', 'error');
                return;
            }

            parsedData2 = [];
            const debugInfo = [];
            const lines = input.split('\n').map(line => line.trim()).filter(line => line !== '');

            let i = 0;
            while (i < lines.length) {
                if (i + 4 < lines.length) {
                    const bookmakerName = lines[i].toLowerCase();
                    const quoteYes = parseFloat(lines[i + 2]);
                    const quoteNo = parseFloat(lines[i + 3]);

                    if (!isNaN(quoteYes) && !isNaN(quoteNo)) {
                        parsedData2.push({
                            bookmaker: bookmakerName,
                            quoteYes: quoteYes,
                            quoteNo: quoteNo,
                            isSharp: sharpBookmakers.includes(bookmakerName)
                        });
                        i += 5;
                        continue;
                    }
                }
                i++;
            }

            if (parsedData2.length === 0) {
                showNotification('Nessun dato valido trovato', 'error');
                document.getElementById('debugInfo2').innerHTML = debugInfo.join('<br>');
                document.getElementById('debugInfo2').style.display = 'block';
            } else {
                document.getElementById('debugInfo2').style.display = 'none';
                displayResults2();
                updateStats2();
                updateAiqCalculatorFromParser2();
                resetSort2();
                showNotification(`Trovati ${parsedData2.length} bookmaker (2 esiti)`, 'success');
            }
        }

        function calculateStatistics2() {
            if (parsedData2.length === 0) {
                return {
                    avgYes: 0, avgNo: 0,
                    minYes: 0, minNo: 0,
                    maxYes: 0, maxNo: 0,
                    minBookYes: '', minBookNo: '',
                    maxBookYes: '', maxBookNo: '',
                    pinnacleYes: null, pinnacleNo: null,
                    betfairYes: null, betfairNo: null,
                    sharpCount: 0
                };
            }

            let minYes = parsedData2[0].quoteYes, minNo = parsedData2[0].quoteNo;
            let maxYes = parsedData2[0].quoteYes, maxNo = parsedData2[0].quoteNo;
            let minBookYes = parsedData2[0].bookmaker, minBookNo = parsedData2[0].bookmaker;
            let maxBookYes = parsedData2[0].bookmaker, maxBookNo = parsedData2[0].bookmaker;
            let totalYes = 0, totalNo = 0;
            let sharpCount = 0;

            let pinnacleYes = null, pinnacleNo = null;
            let betfairYes = null, betfairNo = null;

            parsedData2.forEach(item => {
                totalYes += item.quoteYes;
                totalNo += item.quoteNo;

                if (item.quoteYes < minYes) { minYes = item.quoteYes; minBookYes = item.bookmaker; }
                if (item.quoteYes > maxYes) { maxYes = item.quoteYes; maxBookYes = item.bookmaker; }
                if (item.quoteNo < minNo) { minNo = item.quoteNo; minBookNo = item.bookmaker; }
                if (item.quoteNo > maxNo) { maxNo = item.quoteNo; maxBookNo = item.bookmaker; }
                
                if (item.bookmaker === 'pinnacle') {
                    pinnacleYes = item.quoteYes;
                    pinnacleNo = item.quoteNo;
                    sharpCount++;
                }
                if (item.bookmaker === 'betfair') {
                    betfairYes = item.quoteYes;
                    betfairNo = item.quoteNo;
                    sharpCount++;
                }
            });

            return {
                avgYes: totalYes / parsedData2.length,
                avgNo: totalNo / parsedData2.length,
                minYes, minNo,
                maxYes, maxNo,
                minBookYes, minBookNo,
                maxBookYes, maxBookNo,
                pinnacleYes, pinnacleNo,
                betfairYes, betfairNo,
                sharpCount
            };
        }

        function updateStats2() {
            const stats = calculateStatistics2();
            
            document.getElementById('totalBooks2').textContent = parsedData2.length;
            document.getElementById('sharpBooks2').textContent = stats.sharpCount;

            document.getElementById('avgQuoteYes').textContent = stats.avgYes.toFixed(2);
            document.getElementById('minQuoteYes').textContent = stats.minYes.toFixed(2);
            document.getElementById('maxQuoteYes').textContent = stats.maxYes.toFixed(2);
            document.getElementById('minBookYes').textContent = formatBookmakerName(stats.minBookYes);
            document.getElementById('maxBookYes').textContent = formatBookmakerName(stats.maxBookYes);
            
            document.getElementById('pinnacleQuoteYes').textContent = stats.pinnacleYes !== null ? stats.pinnacleYes.toFixed(2) : '-';
            document.getElementById('betfairQuoteYes').textContent = stats.betfairYes !== null ? stats.betfairYes.toFixed(2) : '-';

            document.getElementById('avgQuoteNo').textContent = stats.avgNo.toFixed(2);
            document.getElementById('minQuoteNo').textContent = stats.minNo.toFixed(2);
            document.getElementById('maxQuoteNo').textContent = stats.maxNo.toFixed(2);
            document.getElementById('minBookNo').textContent = formatBookmakerName(stats.minBookNo);
            document.getElementById('maxBookNo').textContent = formatBookmakerName(stats.maxBookNo);
            
            document.getElementById('pinnacleQuoteNo').textContent = stats.pinnacleNo !== null ? stats.pinnacleNo.toFixed(2) : '-';
            document.getElementById('betfairQuoteNo').textContent = stats.betfairNo !== null ? stats.betfairNo.toFixed(2) : '-';
        }

        function updateAiqCalculatorFromParser2() {
            const stats = calculateStatistics2();
            
            // Aggiorna il calcolatore AIQ TENNIS con i dati del parser
            if (stats.pinnacleYes !== null) {
                document.getElementById('AIQ TENNIS_Sharp_HOME').value = stats.pinnacleYes.toFixed(2);
                document.getElementById('AIQ TENNIS_Sharp_AWAY').value = stats.pinnacleNo.toFixed(2);
            } else if (stats.betfairYes !== null) {
                document.getElementById('AIQ TENNIS_Sharp_HOME').value = stats.betfairYes.toFixed(2);
                document.getElementById('AIQ TENNIS_Sharp_AWAY').value = stats.betfairNo.toFixed(2);
            }
            
            document.getElementById('AIQ TENNIS_Media_HOME').value = stats.avgYes.toFixed(2);
            document.getElementById('AIQ TENNIS_Media_AWAY').value = stats.avgNo.toFixed(2);
            
            document.getElementById('AIQ TENNIS_Min_HOME').value = stats.minYes.toFixed(2);
            document.getElementById('AIQ TENNIS_Max_HOME').value = stats.maxYes.toFixed(2);
            
            document.getElementById('AIQ TENNIS_Min_AWAY').value = stats.minNo.toFixed(2);
            document.getElementById('AIQ TENNIS_Max_AWAY').value = stats.maxNo.toFixed(2);
            
            // Ricalcola AIQ
            calculateAiq('AIQ TENNIS', 'HOME');
            calculateAiq('AIQ TENNIS', 'AWAY');
        }

        function displayResults2() {
            const tableBody = document.getElementById('resultsTable2');
            const emptyState = document.getElementById('emptyState2');
            
            if (parsedData2.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            
            tableBody.innerHTML = parsedData2.map(item => `
                <tr>
                    <td>
                        <span class="bookmaker-name ${item.isSharp ? 'sharp' : ''}">
                            ${formatBookmakerName(item.bookmaker)}
                            ${item.isSharp ? ' âš¡' : ''}
                        </span>
                    </td>
                    <td style="text-align: center;">
                        <span class="quote-cell quote-yes-cell">${item.quoteYes.toFixed(2)}</span>
                    </td>
                    <td style="text-align: center;">
                        <span class="quote-cell quote-no-cell">${item.quoteNo.toFixed(2)}</span>
                    </td>
                </tr>
            `).join('');
        }

        function clearData2Esiti() {
            document.getElementById('inputData2').value = '';
            parsedData2 = [];
            displayResults2();
            updateStats2();
            resetSort2();
            showNotification('Dati 2 esiti puliti', 'info');
        }

        // ==============================
        // FUNZIONI COMUNI
        // ==============================
        function formatBookmakerName(name) {
            if (!name) return '-';
            const cleanName = name.replace(/\.[a-z]+$/, '');
            return cleanName.charAt(0).toUpperCase() + cleanName.slice(1);
        }

        // ==============================
        // FUNZIONI ORDINAMENTO 3 ESITI
        // ==============================
        function sortTable3(column) {
            const header = document.querySelector(`#tab-3esiti th[onclick="sortTable3('${column}')"]`);
            
            if (currentSort3.column === column) {
                currentSort3.direction = currentSort3.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort3.column = column;
                currentSort3.direction = 'asc';
            }
            
            document.querySelectorAll('#tab-3esiti .sortable-header').forEach(h => {
                h.classList.remove('asc', 'desc');
                h.setAttribute('data-sort', 'none');
            });
            
            header.classList.add(currentSort3.direction);
            header.setAttribute('data-sort', currentSort3.direction);
            
            sortData3(column, currentSort3.direction);
            displayResults3();
        }

        function sortData3(column, direction) {
            if (parsedData3.length === 0) return;
            
            parsedData3.sort((a, b) => {
                let valueA, valueB;
                
                switch(column) {
                    case 'bookmaker':
                        valueA = a.bookmaker.toLowerCase();
                        valueB = b.bookmaker.toLowerCase();
                        break;
                    case 'quote1':
                        valueA = a.quote1;
                        valueB = b.quote1;
                        break;
                    case 'quoteX':
                        valueA = a.quoteX;
                        valueB = b.quoteX;
                        break;
                    case 'quote2':
                        valueA = a.quote2;
                        valueB = b.quote2;
                        break;
                    default:
                        return 0;
                }
                
                if (direction === 'asc') {
                    if (valueA < valueB) return -1;
                    if (valueA > valueB) return 1;
                    return 0;
                } else {
                    if (valueA > valueB) return -1;
                    if (valueA < valueB) return 1;
                    return 0;
                }
            });
        }

        function resetSort3() {
            currentSort3.column = null;
            currentSort3.direction = 'asc';
            document.querySelectorAll('#tab-3esiti .sortable-header').forEach(h => {
                h.classList.remove('asc', 'desc');
                h.setAttribute('data-sort', 'none');
            });
        }

        // ==============================
        // FUNZIONI ORDINAMENTO 2 ESITI
        // ==============================
        function sortTable2(column) {
            const header = document.querySelector(`#tab-2esiti th[onclick="sortTable2('${column}')"]`);
            
            if (currentSort2.column === column) {
                currentSort2.direction = currentSort2.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort2.column = column;
                currentSort2.direction = 'asc';
            }
            
            document.querySelectorAll('#tab-2esiti .sortable-header').forEach(h => {
                h.classList.remove('asc', 'desc');
                h.setAttribute('data-sort', 'none');
            });
            
            header.classList.add(currentSort2.direction);
            header.setAttribute('data-sort', currentSort2.direction);
            
            sortData2(column, currentSort2.direction);
            displayResults2();
        }

        function sortData2(column, direction) {
            if (parsedData2.length === 0) return;
            
            parsedData2.sort((a, b) => {
                let valueA, valueB;
                
                switch(column) {
                    case 'bookmaker':
                        valueA = a.bookmaker.toLowerCase();
                        valueB = b.bookmaker.toLowerCase();
                        break;
                    case 'quoteYes':
                        valueA = a.quoteYes;
                        valueB = b.quoteYes;
                        break;
                    case 'quoteNo':
                        valueA = a.quoteNo;
                        valueB = b.quoteNo;
                        break;
                    default:
                        return 0;
                }
                
                if (direction === 'asc') {
                    if (valueA < valueB) return -1;
                    if (valueA > valueB) return 1;
                    return 0;
                } else {
                    if (valueA > valueB) return -1;
                    if (valueA < valueB) return 1;
                    return 0;
                }
            });
        }

        function resetSort2() {
            currentSort2.column = null;
            currentSort2.direction = 'asc';
            document.querySelectorAll('#tab-2esiti .sortable-header').forEach(h => {
                h.classList.remove('asc', 'desc');
                h.setAttribute('data-sort', 'none');
            });
        }

        // ==============================
        // FUNZIONI ESPORTAZIONE (semplificate)
        // ==============================
        function exportToCSV3() {
            if (parsedData3.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            const stats = calculateStatistics3();
            
            let csvContent = "BOOKMAKER 3 ESITI\n";
            csvContent += `Esportato il: ${new Date().toLocaleString()}\n`;
            csvContent += `Bookmaker totali: ${parsedData3.length}\n`;
            csvContent += `Bookmaker Sharp trovati: ${stats.sharpCount}\n\n`;
            
            csvContent += "DETTAGLIO BOOKMAKER\n";
            csvContent += "Bookmaker,Quote 1,Quote X,Quote 2,Sharp\n";
            
            parsedData3.forEach(item => {
                csvContent += `${formatBookmakerName(item.bookmaker)},${item.quote1},${item.quoteX},${item.quote2},${item.isSharp ? 'SI' : 'NO'}\n`;
            });
            
            csvContent += "\n\nSTATISTICHE\n";
            csvContent += "Statistica,Quote 1,Quote X,Quote 2\n";
            csvContent += `Media,${stats.avg1.toFixed(2)},${stats.avgX.toFixed(2)},${stats.avg2.toFixed(2)}\n`;
            csvContent += `Minima,${stats.min1.toFixed(2)},${stats.minX.toFixed(2)},${stats.min2.toFixed(2)}\n`;
            csvContent += `Massima,${stats.max1.toFixed(2)},${stats.maxX.toFixed(2)},${stats.max2.toFixed(2)}\n`;
            
            csvContent += `Pinnacle,${stats.pinnacle1 !== null ? stats.pinnacle1.toFixed(2) : '-'},${stats.pinnacleX !== null ? stats.pinnacleX.toFixed(2) : '-'},${stats.pinnacle2 !== null ? stats.pinnacle2.toFixed(2) : '-'}\n`;
            csvContent += `Betfair,${stats.betfair1 !== null ? stats.betfair1.toFixed(2) : '-'},${stats.betfairX !== null ? stats.betfairX.toFixed(2) : '-'},${stats.betfair2 !== null ? stats.betfair2.toFixed(2) : '-'}\n`;

            downloadFile(csvContent, 'bookmaker_3esiti.csv', 'text/csv');
            showNotification('CSV 3 esiti esportato', 'success');
        }

        function exportToJSON3() {
            if (parsedData3.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            const stats = calculateStatistics3();
            const exportData = {
                bookmakers: parsedData3,
                statistics: {
                    total: parsedData3.length,
                    sharpCount: stats.sharpCount,
                    percentageSharp: parsedData3.length > 0 ? (stats.sharpCount / parsedData3.length) * 100 : 0,
                    quotes1: {
                        average: stats.avg1,
                        minimum: stats.min1,
                        maximum: stats.max1,
                        pinnacle: stats.pinnacle1,
                        betfair: stats.betfair1
                    },
                    quotesX: {
                        average: stats.avgX,
                        minimum: stats.minX,
                        maximum: stats.maxX,
                        pinnacle: stats.pinnacleX,
                        betfair: stats.betfairX
                    },
                    quotes2: {
                        average: stats.avg2,
                        minimum: stats.min2,
                        maximum: stats.max2,
                        pinnacle: stats.pinnacle2,
                        betfair: stats.betfair2
                    }
                },
                timestamp: new Date().toISOString()
            };

            const jsonContent = JSON.stringify(exportData, null, 2);
            downloadFile(jsonContent, 'bookmaker_3esiti.json', 'application/json');
            showNotification('JSON 3 esiti esportato', 'success');
        }

        function exportToTXT3() {
            if (parsedData3.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            let txtContent = `Bookmaker 3 Esiti - ${new Date().toLocaleString()}\n`;
            txtContent += '='.repeat(40) + '\n\n';
            txtContent += `Bookmaker totali: ${parsedData3.length}\n\n`;
            
            parsedData3.forEach(item => {
                txtContent += `${formatBookmakerName(item.bookmaker).padEnd(20)} ${item.quote1.toFixed(2).padStart(6)} ${item.quoteX.toFixed(2).padStart(6)} ${item.quote2.toFixed(2).padStart(6)} ${item.isSharp ? 'âš¡' : ''}\n`;
            });

            downloadFile(txtContent, 'bookmaker_3esiti.txt', 'text/plain');
            showNotification('TXT 3 esiti esportato', 'success');
        }

        function exportToCSV2() {
            if (parsedData2.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            const stats = calculateStatistics2();
            
            let csvContent = "BOOKMAKER 2 ESITI\n";
            csvContent += `Esportato il: ${new Date().toLocaleString()}\n`;
            csvContent += `Bookmaker totali: ${parsedData2.length}\n\n`;
            
            csvContent += "DETTAGLIO BOOKMAKER\n";
            csvContent += "Bookmaker,Quote SÃ¬,Quote No,Sharp\n";
            
            parsedData2.forEach(item => {
                csvContent += `${formatBookmakerName(item.bookmaker)},${item.quoteYes},${item.quoteNo},${item.isSharp ? 'SI' : 'NO'}\n`;
            });
            
            csvContent += "\n\nSTATISTICHE\n";
            csvContent += "Statistica,Quote SÃ¬,Quote No\n";
            csvContent += `Media,${stats.avgYes.toFixed(2)},${stats.avgNo.toFixed(2)}\n`;
            csvContent += `Minima,${stats.minYes.toFixed(2)},${stats.minNo.toFixed(2)}\n`;
            csvContent += `Massima,${stats.maxYes.toFixed(2)},${stats.maxNo.toFixed(2)}\n`;
            
            csvContent += `Pinnacle,${stats.pinnacleYes !== null ? stats.pinnacleYes.toFixed(2) : '-'},${stats.pinnacleNo !== null ? stats.pinnacleNo.toFixed(2) : '-'}\n`;
            csvContent += `Betfair,${stats.betfairYes !== null ? stats.betfairYes.toFixed(2) : '-'},${stats.betfairNo !== null ? stats.betfairNo.toFixed(2) : '-'}\n`;

            downloadFile(csvContent, 'bookmaker_2esiti.csv', 'text/csv');
            showNotification('CSV 2 esiti esportato', 'success');
        }

        function exportToJSON2() {
            if (parsedData2.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            const stats = calculateStatistics2();
            const exportData = {
                bookmakers: parsedData2,
                statistics: {
                    total: parsedData2.length,
                    sharpCount: stats.sharpCount,
                    percentageSharp: parsedData2.length > 0 ? (stats.sharpCount / parsedData2.length) * 100 : 0,
                    quotesYes: {
                        average: stats.avgYes,
                        minimum: stats.minYes,
                        maximum: stats.maxYes,
                        pinnacle: stats.pinnacleYes,
                        betfair: stats.betfairYes
                    },
                    quotesNo: {
                        average: stats.avgNo,
                        minimum: stats.minNo,
                        maximum: stats.maxNo,
                        pinnacle: stats.pinnacleNo,
                        betfair: stats.betfairNo
                    }
                },
                timestamp: new Date().toISOString()
            };

            const jsonContent = JSON.stringify(exportData, null, 2);
            downloadFile(jsonContent, 'bookmaker_2esiti.json', 'application/json');
            showNotification('JSON 2 esiti esportato', 'success');
        }

        function exportToTXT2() {
            if (parsedData2.length === 0) {
                showNotification('Nessun dato da esportare', 'error');
                return;
            }

            let txtContent = `Bookmaker 2 Esiti - ${new Date().toLocaleString()}\n`;
            txtContent += '='.repeat(40) + '\n\n';
            txtContent += `Bookmaker totali: ${parsedData2.length}\n\n`;
            
            parsedData2.forEach(item => {
                txtContent += `${formatBookmakerName(item.bookmaker).padEnd(20)} ${item.quoteYes.toFixed(2).padStart(6)} ${item.quoteNo.toFixed(2).padStart(6)} ${item.isSharp ? 'âš¡' : ''}\n`;
            });

            downloadFile(txtContent, 'bookmaker_2esiti.txt', 'text/plain');
            showNotification('TXT 2 esiti esportato', 'success');
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'error' ? '#dc2626' : 
                                           type === 'success' ? '#059669' : '#1a1a1a';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // ==============================
        // INIZIALIZZAZIONE
        // ==============================
        window.onload = function() {
            // Calcola valori iniziali AIQ
            calculateAiq('AIQ CALCIO', 'HOME');
            calculateAiq('AIQ CALCIO', 'DRAW');
            calculateAiq('AIQ CALCIO', 'AWAY');
            calculateAiq('AIQ TENNIS', 'HOME');
            calculateAiq('AIQ TENNIS', 'AWAY');
            
            // Parse automatico all'avvio
            parseData3Esiti();
            parseData2Esiti();
            
            // Auto-parse quando si incolla
            document.getElementById('inputData3').addEventListener('paste', function() {
                setTimeout(parseData3Esiti, 100);
            });
            
            document.getElementById('inputData2').addEventListener('paste', function() {
                setTimeout(parseData2Esiti, 100);
            });

            // Shortcut Ctrl+Enter per parsare
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    const activeTab = document.querySelector('.tab-content.active');
                    if (activeTab.id === 'tab-3esiti') {
                        parseData3Esiti();
                    } else {
                        parseData2Esiti();
                    }
                }
            });
        };
    </script>
</body>
</html>